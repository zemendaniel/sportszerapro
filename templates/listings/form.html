{% extends "base.html" %}

{% block title %}
{% if create %}
    Létrehozás
{% else %}
    Szerkesztés
{% endif %}
{% endblock %}

{% block head %}
{% endblock %}

{% block main %}
{% if create %}
    <div class="my-2">
        {% include "listings/breadcrumb.html" %}
    </div>
{% endif %}
<form method="post" onchange="changed = true;" id="form-meta">
    {{ form.csrf_token() }}
    <div class="form-group mb-1">
        {{ form.title.label }}
        {{ form.title(class="form-control" )}}
    </div>
    <div class="form-group mb-1">
        {{ form.intent.label }}
        {{ form.intent(class="form-control" )}}
    </div>
    <div class="form-group mb-1">
        {{ form.condition.label }}
        {{ form.condition(class="form-control" )}}
    </div>
    <div class="form-group mb-1">
        {{ form.description.label }}
        {{ form.description(class="form-control no-resize" )}}
    </div>
    <div class="form-group mb-1">
        {{ form.price.label }}
        {{ form.price(class="form-control" )}}
    </div>
    <div class="form-group mb-1">
        {{ form.location.label }}
        {{ form.location(class="form-control" )}}
    </div>
    {% for field in form if 'attr_' in field.name %}
        <div class="form-group mb-1">
          {{ field.label }}
          {% if field.type == "BooleanField" %}
            {{ field() }}
          {% else %}
            {{ field(class="form-control") }}
          {% endif %}
        </div>
      {% endfor %}
    <div class="form-group">
        <button type="submit" class="btn btn-primary-dark">
            <i class="fa-solid fa-floppy-disk"></i> Mentés
        </button>
    </div>

</form>

<div class="d-flex align-items-center">
        {% if not create %}
            <form action="{{ url_for('listings.delete', listing_id=listing.id) }}" method="post"
                  onsubmit='return confirm("Biztosan törli?")' class="d-inline">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                <button type="submit" class="btn btn-dark mx-2">
                    <i class="fa-solid fa-trash-can"></i> Törlés
                </button>
            </form>
        {% endif %}
</div>

<script>
    let changed = false;
    function confirmChanges(){
        if (changed === true){
            return confirm("Biztosan kilép? Nem mentett módosítások vannak.");
        }
        return true;
    }
</script>

{% endblock %}
